[{"categories":["LifeStyle"],"contents":"iOS 資訊安全加固方案 - 程式碼混淆(SwiftShield)  最近專案接到需求，為了避免程式被反解譯，也避免程式的核心業務邏輯暴露在外，故開始尋找 App 加固的方案。\n資訊安全這門領域其實很深，那既然剛入門我們就從基礎的開始，程式碼混淆在資安方案中算是 CP 值比較高的，開發者混淆時付出一些時間(熟悉以後還可以自動化)，但讓駭客就要多付出好幾倍的時間去破解你的程式，所以在基礎的資安加固方案中會比較推薦程式碼混淆。\n為什麼要做程式碼混淆？ 最近專案接到需求，為了避免程式被反解譯，也避免程式的核心業務邏輯暴露在外，故開始尋找 App 加固的方案。\n資訊安全這門領域其實很深，那既然剛入門我們就從基礎的開始，程式碼混淆在資安方案中算是 CP 值比較高的，開發者混淆時付出一些時間(熟悉以後還可以自動化)，但讓駭客就要多付出好幾倍的時間去破解你的程式，所以在基礎的資安加固方案中會比較推薦程式碼混淆。\n.\n如何做到程式碼混淆？ 市面上有許多的混淆工具，有收費的也有開源的，如果只是想試點水溫會建議用開源的工具玩玩看。但如果專案有時程壓力，可以試試付費的工具，畢竟省時省力 😂。\n這邊我列舉出幾個比較常見的開源混淆工具：\n(1) 「rockbruno/SwiftShield」:  這是我比較推薦的一個，效能不錯、評價高、重點是還有在維護。 手動模式（Objective-C、Swift）：採後綴混淆，簡單易用，缺點是有特定後綴的才會混淆，不適合已開發的專案。 自動模式（Swift）：全局混淆，也可以指定特定資料夾不混淆，缺點是有些語法混淆後會出錯，需要手動修復或是修改原本的程式寫法，但錯誤通常不多。  (2) 「LennonChin/Code-Confuse-Plugin」:  僅混淆 Objective-C 項目(.h.m)，Swift 需指定忽略。 需求為 Python3，以 Define 定義來替換方法名、類別名。  (3) 「onorZhang/iOSConfuse」:  採用前綴的方式進行混淆，一樣不適合已開發的專案。  使用 SwiftShield 進行程式碼混淆 SwiftShield 是一個將 iOS 專案程式碼產製亂數加密名稱的工具，其混淆範圍包含程式碼、Pod 和 Storyboard，可以保護應用程序避免被輕易的反解譯（如 class-dump 和 Cycript）。\n混淆後會是什麼樣子？ class fjiovh4894bvic: XbuinvcxoDHFh3fjid { func cxncjnx8fh83FDJSDd() { return vPAOSNdcbif372hFKF() } } 自動模式（限 Swift 使用） 使用-automatic指令，SwiftShield 將使用 SourceKit 自動混淆整個專案，混淆範圍包含程式碼、Pod 和 Storyboard。\n注意事項 ⚠️  目前有一些 SourceKit Bugs 及不會混淆的類型需注意，如果專案中剛好有遇到特定情境可能需要修改程式碼，詳請請參照本連結。 檔案名稱及資料夾名稱不可包含空白，否則執行混淆時會報錯。 檔案名稱及資料夾名稱若有\u0026quot;-\u0026ldquo;依然會被混淆。  執行步驟  從此處下載最新的 SwiftShield 打開終端機，cd 移動至下載的 Swiftsheild 文件夾下 設置 SwiftShield 的使用權限  # 給予讀、寫、執行的權限 $ sudo chmod -R 777 ./swiftsheild(文件路徑) # 如果使用CocoaPods，需要解鎖權限 $ sudo chmod -R 774 [專案路徑] 官方文件有提到，如果有使用到會修改文件的第三方框架，如：R.Swift、SwiftGen，需在專案中的 TARGETS -\u0026gt; Build Phases -\u0026gt; Run Script 修改指令，這裡以 R.Swift 為範例：  # 原本的 Run Script \u0026quot;$PODS_ROOT/R.swift/rswift\u0026quot; generate \u0026quot;$SRCROOT/[專案名稱]\u0026quot; # 修改後的 Run Script if [ \u0026quot;$SWIFTSHIELDED\u0026quot; != \u0026quot;true\u0026quot; ]; then \u0026quot;$PODS_ROOT/R.swift/rswift\u0026quot; generate \u0026quot;$SRCROOT/[專案名稱]\u0026quot; fi  準備就緒後就可以來下指令進行混淆了，自動模式的指令有以下幾種\n必填參數：\n -automatic：啟用自動模式。 -project-root：專案項目的根目錄。 SwiftShield 會向下搜索你的項目文件。 -automatic-project-file：專案項目的主要.xcodeproj / .xcworkspace文件。 -automatic-project-scheme [myScheme]：專案項目的Scheme。  可選參數：\n -sdk：防止混淆公共類別和方法。如果你正在構建SDK項目，請使用它。 -ignore-modules：防止混淆某些資料夾，並以逗號分隔。如果無法正確混淆某個資料夾，請使用此選項。 要注意的是，是輸入資料夾的確切名稱，而不是目標名稱。例：MyLib,MyAppRichNotifications,MyAppWatch_Extension -show-sourcekit-queries：打印發送到 SourceKit 的查詢。要注意的是這指令會造成非常龐大的輸出，因此只能將其用於錯誤報告和功能開發！  實際組出來以後\n  $ #指令結構 $[SwiftShield 路徑]+空白+\u0026quot;swiftshield\u0026quot;+空白+\u0026quot;-automatic\u0026quot;+空白+\u0026quot;-project-root\u0026quot;+空白+\u0026quot;-automatic-project-file\u0026quot;+空白+[xcworkspace 路徑]+空白+\u0026quot;-automatic-project-scheme\u0026quot;+空白+[專案Target]+空白+\u0026quot;-ignore-modules\u0026quot;+空白+[要忽略的項目(含Pods項目，且需以資料夾名稱為主)] $ #實際執行指令 $ /Users/mac/swiftshield-3.5.1/bin/swiftshield swiftshield -automatic -project-root /Users/mac/[專案資料夾名稱] -automatic-project-file /Users/mac/[專案名稱].xcworkspace -automatic-project-scheme [專案Target] -ignore-modules Alamofire,MJRefresh,SDWebImage...  指令需要執行一小段時間，過程會看到Building project to gather modules and compiler arguments...、Overwriting、Checking等訊息。\n  接著直接打開專案執行看看，通常會出現一點混淆錯誤的Error，基本上都是重複的錯誤，這部分跟程式寫法有關。若不想改動原本程式碼，基本上混淆後再逐一修改即可發布。\n  混淆失敗怎麼辦？ 編譯過程失敗\n 檢查所有檔案名稱或資料夾名稱是否有包含空白。 檢查是否給與正確的權限。 打開下載的 swiftshield 執行檔是否有被 MacOS 安全性阻擋。  混淆後專案執行失敗或 Crash\n 檢查是否有使用到SourceKit Bugs 及不會混淆的類型。 帶 selector 方法的參數中若含有字串，盡量用變量或常量代替  // 修改前 let item1 = UIBarButtonItem(title: \u0026quot;取消\u0026quot;, style: .plain, target: self, action: #selector(cancelButtonClick(sender:))) //混淆後會​​報錯，混淆後會把）}一起混淆進去，導致項目缺少）}而報錯 // 修改後 let cencelTitle = \u0026quot;取消\u0026quot; let item1 = UIBarButtonItem(title: cencelTitle, style: .plain, target: self, action: #selector(cancelButtonClick(sender:))) .xib 文件有可能不會連動到混淆後的類別，要修改File's Owner 若錯誤不多可以手動修復，混淆後會產生 swiftshield-output 資料夾，內有conversionMap.txt，可以對應混淆前後的字串。  對加密的 Crash logs 進行反混淆處理 成功混淆專案後，SwiftShield 將產生一個輸出文件夾，其中包含一個conversionMap.txt 文件，其中包含對該專案所做的所有更改，讓你查明加密對象的前後的字串。\n// // SwiftShield // Conversion Map // Automatic mode for MyApp 2.0 153, 2018-09-24 10.23.48 // Data: ViewController ===\u0026gt; YytSIcFnBAqTAyR AppDelegate ===\u0026gt; uJXJkhVbwdQGNhh SuperImportantClassThatShouldBeHidden ===\u0026gt; GDqKGsHjJsWQzdq 如果你要對混淆後的程式碼文件進行復原，可以透過以下指令復原\n$ swiftshield -deobfuscate CRASH_FILE -deobfuscate-map PATH_TO_CONVERSION_MAP 總結 資訊安全的領域很深，從連線加密、程式碼混淆、LLVM編譯器混淆等等一關接著一關，都是為了保護重要的機密或接口不會被竊取盜用，造成商業損失。\n其實 iOS 系統已經是相對安全的，但對於通訊、金融行業還是要有一定程度的資安保護，畢竟任何資安加固的措施都不能保證百分之百安全，但透過增加駭客反編譯的難度，就能有效降低駭客破解的速度及讓駭客放棄破解打退堂鼓。\nReference  SwiftShield SwiftShield代碼混淆 Swiftshield：SwiftOBJ-C 代碼混淆工具  另外我在搜尋資料時也意外發現有幾篇文章不錯，也分享跟大家。\n 資訊安全從連線加密入手  ","date":"06","image":"https://i.imgur.com/Xa73TNl.png","permalink":"https://martinhuang0933.github.io/blog/post-9/","tags":["Diy","Toy"],"title":"How to make toys from old Olarpaper"},{"categories":["LifeStyle"],"contents":"Nemo vel ad consectetur namut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\nLorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\nCreative Design Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n","date":"05","image":"images/post/01.jpg","permalink":"https://martinhuang0933.github.io/blog/post-8/","tags":["Diy","Toy"],"title":"How to make toys from old Olarpaper"},{"categories":["Photography"],"contents":"Photography is an invaluable medium that allows us to capture the incandescent beauty of the outside world, something many of us haven’t seen in\u0026hellip; well, a hot minute. Global pandemics will do that.\nBut that certainly doesn’t mean that beautiful photos can’t be taken indoors, out of windows, or in secluded outdoor locations (safely socially distanced, of course). And perhaps now is as good a time as any to gain some helpful tips on how to do just that by taking an online photography course.\nCreative Design Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n","date":"04","image":"images/post/02.jpg","permalink":"https://martinhuang0933.github.io/blog/post-7/","tags":["Photography"],"title":"What you need to know about Photography"},{"categories":["LifeStyle"],"contents":"Almost every day for the past nine or so months has felt like March 13, and that can sometimes make it difficult to want to wake up for the day ahead of you.\nTo make a morning person out of you, the wake-up light simulates the sunrise to gradually ease you awake. This allows you to wake up more naturally rather than being jolted awake by the default iPhone alarm sound, which honestly triggers my fight or flight response.\nCreative Design Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n","date":"03","image":"images/post/03.jpg","permalink":"https://martinhuang0933.github.io/blog/post-6/","tags":["Alarm","Clock"],"title":"Become a morning person with the help of this a alarm clock"},{"categories":["Accessories"],"contents":"A balloon is a flexible bag that can be inflated with a gas, such as helium, hydrogen, nitrous oxide, oxygen, and air. For special tasks, balloons can be filled with smoke, liquid water, granular media, or light sources.\nLorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\nCreative Design Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n","date":"02","image":"images/post/04.jpg","permalink":"https://martinhuang0933.github.io/blog/post-5/","tags":["Balloon","Gas"],"title":"Why a balloon is a flexible bag that can be inflated with a gas"},{"categories":["Food"],"contents":"A banana is an elongated, edible fruit – botanically a berry – produced by several kinds of large herbaceous flowering plants in the genus Musa. In some countries, bananas used for cooking may be called \u0026ldquo;plantains\u0026rdquo;, distinguishing them from dessert bananas.\nLorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\nCreative Design Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n","date":"25","image":"images/post/05.jpg","permalink":"https://martinhuang0933.github.io/blog/post-4/","tags":["Food","Gold"],"title":"Banana is the best meal packages in the UK spark outrage online"},{"categories":["LifeStyle"],"contents":"A paper diamond is such a pretty way to bring a flair of stylish luxury to your home.. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\nLorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\nCreative Design Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n","date":"25","image":"images/post/06.jpg","permalink":"https://martinhuang0933.github.io/blog/post-3/","tags":["Diy","Toy"],"title":"DIY Paper Diamond Tutorial with HUNGRY HEART"},{"categories":["LifeStyle"],"contents":"Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\nLorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\nCreative Design Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n","date":"25","image":"images/post/03.jpg","permalink":"https://martinhuang0933.github.io/blog/post-2/","tags":["Alarm","Clock"],"title":"Become a morning person with the help of this a alarm clock"},{"categories":["Photography"],"contents":"Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\nLorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\nCreative Design Nam ut rutrum ex, venenatis sollicitudin urna. Aliquam erat volutpat. Integer eu ipsum sem. Ut bibendum lacus vestibulum maximus suscipit. Quisque vitae nibh iaculis neque blandit euismod.\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\n Lorem ipsum dolor sit amet consectetur adipisicing elit. Nemo vel ad consectetur ut aperiam. Itaque eligendi natus aperiam? Excepturi repellendus consequatur quibusdam optio expedita praesentium est adipisci dolorem ut eius!\u0000\n","date":"24","image":"images/post/07.jpg","permalink":"https://martinhuang0933.github.io/blog/post-1/","tags":["Photography"],"title":"What you need to know about Photography"}]